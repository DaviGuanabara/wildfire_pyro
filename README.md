# Spatio-Temporal Data Analysis and Simulation Framework

## Installation

You will need **Python 3.12**.

Go to the root folder of the project (the folder that contains `pyproject.toml`), and run:

```bash
pip install .
```

To test the installation, go to the `wildfire_pyro/examples` folder and execute:

```bash
python learning_example.py
```

Once `learning_example.py` is running, you can see the training graphs using Tensorboard in the folder `wildfire_pyro/examples/logs` (generated by the learning_example):

```bash
tensorboard --logdir=logs
```


Other files you can verify:

`sensor_environment_example.py`
`sensor_environment_bootstrap_example.py`


The `optimizer_example.py` file is still under development. However, you can check it to get an overview of the project's future structure.

---

## Overview

This project focuses on **spatiotemporal machine learning** using **sets of random neighbors with deep attention mechanisms**. The primary goal is to **simulate, analyze, and predict** spatiotemporal phenomena based on sparse data collected through fixed or mobile sensors.

The framework follows **Farama Gymnasium** conventions.

### üß© Programming Paradigm
Although this project performs supervised learning, it adopts an architectural style inspired by agent-environment interaction loops, commonly found in reinforcement learning system like Stable Baseline 3.

This interaction-centric architecture enables:

- Clear separation between data, model, and evaluation loop.

- Use of bootstrap-based evaluation for realistic uncertainty modeling.

- Simple integration of callbacks, logging, and monitoring tools such as TensorBoard and progress bars.

- This style enhances modularity, readability, and future extensibility, while retaining the clarity and expressiveness of supervised workflows.


[Archtectural Decisions doc](wildfire_pyro/archtectural_decisions.md)

---

## Purpose and Context

This project aims to:
- Deliver an modular easy to use framework for Supervised Learning problems.
- Efficiently **predict spatial and temporal variables** while incorporating **uncertainty estimation**.
- Demonstrate **real-world applications** across multiple datasets, including **simulated and real-world taxi flow data**.
- Leverage **deep learning models with attention mechanisms** to improve prediction accuracy.

The Deep Neural Network model chan be checked
[Deep Neural Network model doc](wildfire_pyro/models/model.markdown)

---

### **Explanation**
- **data.csv** ‚Üí The raw input dataset.
- **SensorManager** ‚Üí Simulates real-time sensor data, processes input, and assigns sensor IDs.
- **SensorEnvironment** ‚Üí Converts sensor data into a Gym-like environment for ML models.
- **Model Wrapper** ‚Üí Manages interactions between the model and environment.
- **Model** ‚Üí The deep learning model that makes predictions.
- **Callbacks** ‚Üí Integrates with the wrapper to extract information while in training.
---

## Project Status üöß

**üî¥ Current State:**  
The project is **under development** and currently **not functional** due to ongoing architecture changes. Major updates are being implemented.

### ‚úÖ **Completed**
- Initial framework structure.
- Environment setup with **Gymnasium** compatibility.
- SensorManager module for handling sensor data.
- SensorEnvironment to format the SensorManager data.
- Wrapper LearningManager: that handles the learning process for Supervised Learning
- Main Callbacks: like an bootstrap evaluation callback.

### üèó **In Progress**
- **Bootstrap Evaluation Callback Return**
  - Implementing data log in CSV.

- **Hiperparamater Optimizer**
  - Folther structure
  - Log system
  - Select hiperparam -> Evaluate -> Log Cycle implementation
  - Random Generator factory to centralize instantiation and facilitate debug of randomness.

### üîú **Next Steps**
- Validation.
- Update documentation.

---

## System Components

### **1. Data Source**
- **Input:** A CSV file containing sensor data with fields for latitude, longitude, timestamp, and observed values.
- **Sensor Identification:** Each sensor is uniquely identified based on its latitude and longitude.

### **2. Data Flow**
The **SensorManager** module:
- **Loads & preprocesses data** from the CSV file.
- **Simulates real-time data streams** for training.
- **Assigns unique sensor IDs** based on coordinates.
- **Provides access to sensor readings** within a time window.

### **3. Simulation Environment**
The **FixedSensorEnvironment** class:
- Converts data processed by **SensorManager** into the **Farama Gymnasium** format.
- Provides **interfaces for sensor interaction** and **time-step transitions**.

### **4. AI Model Wrapper**
The **deep_set_attention_net_wrapper.py**:
- Acts as an interface between the model and environment.
- Uses a structure similar to **Stable Baselines 3 (SB3)**.
- Supports both **training (`train()`)** and **prediction (`predict()`)**.

### **5. Deep Learning Model**
The **deep_set_attention_net.py**:
- Implements **deep sets with an attention mechanism**.
- Supports **uncertainty estimation** for model predictions.

---

## Features

### ‚úÖ **Random Neighbor Selection**
- Uses **random neighbors** to improve spatial and temporal coverage.

### ‚úÖ **Uncertainty Estimation**
- Provides **confidence intervals** for model predictions.

---

## Usage

### üìÇ **Examples**
You can find example scripts in the `examples/` directory, including:
- **Loading and preprocessing sensor data**.
- **Simulation setup for training and evaluation**.
- **Model training and inference workflows**.

---

## Contact

For questions, suggestions, or contributions, please contact:

üìß **Email: davi.aragao@ga.ita.br** 
üìå **GitHub Issues:**  
üåê **Website/Docs:** 

---

## Acknowledgment

This project is **inspired by** and follows design patterns from **[Stable-Baselines3 (SB3)](https://github.com/DLR-RM/stable-baselines3)**. It incorporates **some modified SB3 code**, but remains a **separate implementation** with different objectives.

The original **SB3** code is licensed under the **MIT License**.

---

## Citation

If you use Stable-Baselines3 as inspiration, please cite their original paper:

```bibtex
@article{stable-baselines3,
  author  = {Antonin Raffin and Ashley Hill and Adam Gleave and Anssi Kanervisto and Maximilian Ernestus and Noah Dormann},
  title   = {Stable-Baselines3: Reliable Reinforcement Learning Implementations},
  journal = {Journal of Machine Learning Research},
  year    = {2021},
  volume  = {22},
  number  = {268},
  pages   = {1-8},
  url     = {http://jmlr.org/papers/v22/20-1364.html}
}
```